<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign-up Form</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main>
      <div class="container-main">
        <h1 id="header-sign-up">Sign Up</h1>
        <div class="form-section">
          <div class="header">
            <p>
              This is not a real online service! You know you need something like this in your life to help you realize your deepest dreams. Sign up
              <em>now</em> to get started.
            </p>
          </div>
          <div class="input-section">
            <form id="my-form" onsubmit="return false">
              <label for=""
                >First Name
                <input type="text" id="firstname" name="firstname" required />
              </label>
              <label for=""
                >Last Name
                <input type="text" id="lastname" name="lastname" required />
              </label>
              <label for=""
                >Email
                <input type="email" id="email" name="email" required autocomplete="off" />
              </label>
              <label for=""
                >Phone Number
                <input type="tel" id="phonenumber" name="phonenumber" required pattern="[0-9]{11}" />
                <div class="error error-phone"></div>
              </label>
              <label for=""
                >Password
                <input type="password" id="password" name="password" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" />
              </label>
              <label for=""
                >Confirm Password
                <input type="password" id="passwordConfirm" name="passwordConfirm" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" />
                <div class="error error-passwordConfirm"></div>
              </label>
            </form>
          </div>
          <div class="container-submit-section">
            <button id="button-signup" type="submit" form="my-form">Sign Up</button>
            <div class="error error-all" style="font-weight: bold"></div>
            <p style="font-size: 15px; margin-left: 20px">
              Already have an account?
              <a href="" style="font-size: 15px">Log in</a>
            </p>
          </div>
        </div>
      </div>
      <img id="img-sign-up" src="img/sign-up.png" alt="Image failed to load" />
    </main>
    <script>
      buttonSignUp = document.querySelector('#button-signup');
      inputs = document.querySelectorAll('input');

      phone = document.querySelector('#phonenumber');
      password = document.querySelector('#password');
      passwordConfirm = document.querySelector('#passwordConfirm');

      errorPasswordConfirm = document.querySelector('.error-passwordConfirm');
      errorPhone = document.querySelector('.error-phone');
      errorAll = document.querySelector('.error-all');

      //If submit was pressed with missing fields
      buttonSignUp.onclick = function () {
        errorCount = 0;
        for (items of inputs) {
          if (items.value === '') {
            items.classList.add('border-red');
            errorCount++;
          }
        }
        if (errorCount > 0) {
          errorAll.textContent = 'Please fill out all required fields.';
        }
      };
      arrAll = ['phonenumber', 'password'];
      arrError = ['Please enter in a 10 digit phone number', 'password'];

      //Border red when pattern or type mismatched
      document.getElementById('my-form').addEventListener('change', function (e) {
        if (e.target.validity.patternMismatch || e.target.validity.typeMismatch) {
          const errorIndex = arrAll.indexOf(e.target.id);
          testt = document.getElementById('my-form').querySelectorAll('.error');
          testt[errorIndex].textContent = arrError[errorIndex];
          e.target.classList.add('border-red');
        } else {
          e.target.classList.remove('border-red');
        }
      });

      // phone.onchange = function (e) {
      //   if (e.target.validity.patternMismatch || e.target.validity.typeMismatch) {
      //     //errorPhone.textContent = 'hakdog';
      //   }

      // };

      passwordConfirm.onchange = passwordConfirmValidation;
      password.onchange = passwordConfirmValidation;

      //password and confirmation validation
      function passwordConfirmValidation() {
        if (passwordConfirm.value === '' || password.value === '') return;
        if (passwordConfirm.value !== password.value) {
          passwordConfirm.classList.add('border-red');
          password.classList.add('border-red');
          errorPasswordConfirm.textContent = 'Password should match. Try again.';
        } else {
          passwordConfirm.classList.remove('border-red');
          password.classList.remove('border-red');
          errorPasswordConfirm.textContent = '';
        }
      }
    </script>
  </body>
</html>
